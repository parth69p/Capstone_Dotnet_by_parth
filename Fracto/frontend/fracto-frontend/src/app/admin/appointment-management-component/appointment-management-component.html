<div class="container my-4 appointments-container">
  <h2 class="mb-4 text-center text-primary fw-bold">üóìÔ∏è Appointments Management</h2>

  <!-- Update form -->
  <div *ngIf="selectedAppointment" class="card border-0 shadow p-4 mb-4 rounded-3">
    <h4 class="mb-3 text-primary fw-semibold">
      Update Appointment (ID: {{ selectedAppointment.id }})
    </h4>

    <form (ngSubmit)="submitUpdate()" class="row g-3">
      <div class="col-md-4">
        <label class="form-label fw-semibold text-muted">Date:</label>
        <input
          type="date"
          [(ngModel)]="selectedAppointment.appointmentDate"
          name="appointmentDate"
          class="form-control rounded-pill shadow-sm"
          required
        />
      </div>

      <div class="col-md-4">
        <label class="form-label fw-semibold text-muted">Time Slot:</label>
        <input
          type="text"
          [(ngModel)]="selectedAppointment.timeSlot"
          name="timeSlot"
          class="form-control rounded-pill shadow-sm"
          placeholder="e.g. 10:00 AM - 11:00 AM"
          required
        />
      </div>

      <div class="col-md-4">
        <label class="form-label fw-semibold text-muted">Status:</label>
        <select
          [(ngModel)]="selectedAppointment.status"
          name="status"
          class="form-select rounded-pill shadow-sm"
        >
          <option value="Pending">Pending</option>
          <option value="Confirmed">Confirmed</option>
          <option value="Cancelled">Cancelled</option>
        </select>
      </div>

      <div class="col-12 mt-3 d-flex gap-2">
        <button type="submit" class="btn btn-primary px-4 rounded-pill shadow-sm">
          üíæ Save
        </button>
        <button
          type="button"
          class="btn btn-light border px-4 rounded-pill shadow-sm"
          (click)="selectedAppointment = null"
        >
          ‚ùå Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- Table of appointments -->
  <div class="card border-0 shadow rounded-3">
    <div class="card-body p-0">
      <div class="table-responsive" *ngIf="appointments.length > 0; else noAppointments">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-primary text-dark">
            <tr>
              <th>ID</th>
              <th>User</th>
              <th>Doctor</th>
              <th>Date</th>
              <th>Time Slot</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let appt of appointments">
              <td class="fw-semibold text-muted">{{ appt.id }}</td>
              <td>{{ appt.userName }}</td>
              <td class="fw-semibold text-primary">{{ appt.doctorName }}</td>
              <td>{{ appt.appointmentDate | date: 'mediumDate' }}</td>
              <td>{{ appt.timeSlot }}</td>
              <td>
                <span
                  class="badge px-3 py-2 rounded-pill shadow-sm"
                  [ngClass]="{
                    'bg-warning text-dark': appt.status === 'Pending',
                    'bg-success': appt.status === 'Confirmed',
                    'bg-danger': appt.status === 'Cancelled'
                  }"
                >
                  {{ appt.status }}
                </span>
              </td>
              <td class="text-center">
                <button
                  class="btn btn-sm btn-outline-danger rounded-pill px-3 me-2"
                  (click)="cancelAppointment(appt.id)"
                  [disabled]="appt.status === 'Cancelled'"
                >
                  ‚ùå Cancel
                </button>
                <button
                  class="btn btn-sm btn-outline-primary rounded-pill px-3"
                  (click)="openUpdateForm(appt)"
                >
                  ‚úèÔ∏è Update
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Message if no appointments -->
      <ng-template #noAppointments>
        <p class="text-center text-muted py-4">No appointments found.</p>
      </ng-template>
    </div>
  </div>
</div>
